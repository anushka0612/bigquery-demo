Counting the number of records in the dataset NYC Bikers Data

SELECT COUNT(*) FROM `bigquery-public-data.new_york.citibike_trips`
Row
f0_


1
33319019



Counting the number of distinct bikers in the dataset NYC Bikers Data

SELECT Count(distinct(bikeid)) FROM `bigquery-public-data.new_york.citibike_trips`


Row
f0_


1
11852



Arranging Station name in the order of ascending bike idâ€™s


SELECT start_station_name FROM `bigquery-public-data.new_york.citibike_trips`
ORDER by bikeid ASC 

Row
start_station_name


1
Centre St & Chambers St


2
E 52 St & 2 Ave


3
Franklin Ave & Myrtle Ave


4
Spruce St & Nassau St


5
W 14 St & The High Line


6
W 59 St & 10 Ave


7
9 Ave & W 45 St


8
12 Ave & W 40 St


9
University Pl & E 14 St


10
Adelphi St & Myrtle Ave


11
West St & Chambers St


12
E 47 St & 1 Ave


13
W 20 St & 7 Ave


14
Watts St & Greenwich St


15
E 30 St & Park Ave S


16
Lafayette St & E 8 St


17
FDR Drive & E 35 St


18
Broadway & E 22 St


19
Broadway & W 49 St


20
6 Ave & Canal St


21
Willoughby St & Fleet St


22
Spruce St & Nassau St


23
W 13 St & 6 Ave


24
Henry St & Atlantic Ave


25
Broadway & E 14 St


26
Warren St & Church St


27
1 Ave & E 44 St


28
W 22 St & 8 Ave


29
Christopher St & Greenwich St


30
W 22 St & 10 Ave


31
E 27 St & 1 Ave


32
Canal St & Rutgers St


33
South End Ave & Liberty St


34
W 4 St & 7 Ave S


35
W 20 St & 8 Ave


36
Broadway & W 49 St


37
Lafayette St & E 8 St


38
W 31 St & 7 Ave


39
12 Ave & W 40 St


40
W 13 St & 5 Ave


41
Broadway & W 36 St


42
9 Ave & W 16 St


43
E 7 St & Avenue A


44
W 13 St & 7 Ave


45
Great Jones St


46
Stanton St & Chrystie St


47
W 20 St & 7 Ave


48
Columbus Ave & W 72 St


49
Dean St & 4 Ave


50
E 11 St & 2 Ave


51
E 11 St & Broadway


52
Central Park S & 6 Ave


53
Graham Ave & Withers St


54
E 9 St & Avenue C


55
Forsyth St & Canal St


56
Mott St & Prince St


57
Pershing Square North


58
Liberty St & Broadway


59
E 17 St & Broadway


60
W 27 St & 7 Ave


61
W 14 St & The High Line


62
W 37 St & 5 Ave


63
W 45 St & 8 Ave


64
E 4 St & 2 Ave


65
W 25 St & 6 Ave


66
E 10 St & Avenue A


67
W 4 St & 7 Ave S


68
E 16 St & 5 Ave


69
York St & Jay St


70
W 53 St & 10 Ave


71
E 39 St & 3 Ave


72
W 4 St & 7 Ave S


73
W 26 St & 10 Ave


74
E 51 St & 1 Ave


75
E 19 St & 3 Ave


76
Little West St & 1 Pl


77
E 24 St & Park Ave S


78
E 20 St & Park Ave


79
W 49 St & 8 Ave


80
Lawrence St & Willoughby St


81
Canal St & Rutgers St


82
W 24 St & 7 Ave


83
E 45 St & 3 Ave


84
W 26 St & 10 Ave


85
E 33 St & 5 Ave


86
5 Ave & E 29 St


87
5 Ave & E 29 St


88
E 24 St & Park Ave S


89
E 32 St & Park Ave


90
Duane St & Greenwich St


91
Central Park West & W 72 St


92
6 Ave & Broome St


93
Broadway & W 41 St


94
E 25 St & 2 Ave


95
West St & Chambers St


96
Greenwich Ave & Charles St


97
Broadway & E 14 St


98
8 Ave & W 31 St


99
Hudson St & Reade St


100
E 47 St & Park Ave





 

SELECT 
 EXTRACT(YEAR from starttime) as year,  
  COUNT(DISTINCT(bikeid)) as num_bikes
FROM `bigquery-public-data.new_york.citibike_trips`
GROUP BY year
ORDER BY year

Row
year
num_bikes


1
2013
6503


2
2014
6811


3
2015
8477


4
2016
10495



SELECT
      start_station_name,
      start_station_latitude,
      start_station_longitude, COUNT(*) as num_trips
FROM
      `bigquery-public-data.new_york.citibike_trips`
GROUP BY
      1,2,3
ORDER BY num_trips DESC
LIMIT 10

















Row
start_station_name
start_station_latitude
start_station_longitude
num_trips


1
E 17 St & Broadway
40.73704984
-73.99009296
291615


2
Lafayette St & E 8 St
40.73028666
-73.9907647
277060


3
W 21 St & 6 Ave
40.74173969
-73.99415556
275348


4
West St & Chambers St
40.71754834
-74.01322069
260911


5
Pershing Square North
40.751873
-73.977706
246181


6
Broadway & E 14 St
40.73454567
-73.99074142
244420


7
Broadway & E 22 St
40.7403432
-73.98955109
237394


8
8 Ave & W 33 St
40.751551
-73.993934
223970


9
W 20 St & 11 Ave
40.746745
-74.007756
211840


10
Broadway & W 24 St
40.7423543
-73.98915076
211713






SELECT  
  usertype,  
  CONCAT(start_station_name, " to ", end_station_name) as route,  
  COUNT(*) as num_trips,  
  ROUND(AVG(cast(tripduration as int64) / 60),2) as duration
FROM  
  `bigquery-public-data.new_york.citibike_trips`
GROUP BY  
  start_station_name, end_station_name, usertype
ORDER BY  
  num_trips DESC
LIMIT 10

Row
usertype
route
num_trips
duration


1
Customer
Central Park S & 6 Ave to Central Park S & 6 Ave
40009
50.89


2
Customer
Grand Army Plaza & Central Park S to Grand Army Plaza & Central Park S
15234
52.99


3
Customer
Centre St & Chambers St to Centre St & Chambers St
12466
35.65


4
Subscriber
W 21 St & 6 Ave to 9 Ave & W 22 St
11594
5.35


5
Customer
Broadway & W 60 St to Broadway & W 60 St
10816
52.36


6
Subscriber
W 21 St & 6 Ave to W 22 St & 10 Ave
10451
6.95


7
Subscriber
E 7 St & Avenue A to Lafayette St & E 8 St
9639
5.59


8
Subscriber
West Thames St to Vesey Pl & River Terrace
9218
6.67


9
Subscriber
W 17 St & 8 Ave to 8 Ave & W 31 St
8760
6.43


10
Subscriber
E 43 St & Vanderbilt Ave to W 41 St & 8 Ave
8743
7.04




SELECT 
      (2016 - cast(birth_year as INT64)) as age,
      COUNT(*) c, 
      COUNT(case WHEN gender = "male" then 1 end) as num_males,
      COUNT(case WHEN gender = "female" then 1 end) as num_females 
FROM 
      `bigquery-public-data.new_york.citibike_trips`
WHERE CAST(birth_year as string) != "null"
GROUP BY age
ORDER BY c DESC


Row
age
c
num_males
num_females


1
31
1240336
898453
340179


2
32
1215430
907695
306279


3
33
1207236
903267
302756


4
30
1176419
841542
334341


5
29
1122408
809837
312188


6
28
1100937
800245
299515


7
34
1090760
816087
272946


8
35
1062609
811865
248841


9
27
1058353
764331
293316


10
36
962572
736928
223516


11
26
947161
693184
252464


12
37
878107
685676
192118


13
38
838321
651049
185702


14
39
779801
603055
175750


15
40
739716
595248
143355


16
46
729206
580748
147161


17
42
705484
567006
137811


18
41
682111
560045
120869


19
25
678964
481684
197071


20
47
651552
524559
126705


21
45
646827
520798
125509


22
44
635028
503301
130090


23
43
625068
498770
126097


24
48
562774
454507
106897


25
49
543422
429419
113757


26
52
506284
418441
87320


27
51
502813
384784
117466


28
53
498467
397442
100883


29
50
498140
393776
103714


30
24
482804
330602
151774


31
54
466147
352936
112986


32
56
422069
319349
102180


33
55
388365
301968
86101


34
57
356025
270718
85253


35
58
333673
253503
79368


36
23
332166
234863
96931


37
59
294865
215003
79667


38
60
268493
213720
54645


39
62
228721
173119
55414


40
61
227728
183833
43895


41
22
205949
149063
56859


42
63
201816
169902
31913


43
21
142694
107635
34912


44
64
141186
116689
24296


45
65
137213
114493
22471


46
20
101213
73121
26017


47
66
95074
73521
21290


48
68
77687
65634
11951


49
67
76642
62984
13455


50
69
61224
52077
9147


51
19
58342
45694
12603


52
70
40984
37498
3486


53
18
38889
31608
7174


54
71
31940
27252
4668


55
74
28586
25937
2649


56
72
28340
23851
4483


57
75
22179
18554
3624


58
73
16978
12650
4328


59
17
16125
12580
3392


60
76
13781
11740
2041


61
78
7419
6495
924


62
116
5929
5869
59


63
77
4522
4132
387


64
16
3082
2309
752


65
80
2523
2231
288


66
81
2433
2116
306


67
131
1681
158
0


68
82
1543
1500
43


69
79
1455
1427
28


70
115
1408
1333
12


71
84
1385
306
1079


72
117
1352
1250
102


73
83
872
861
11


74
90
652
37
615


75
106
644
644
0


76
94
465
465
0


77
99
366
366
0


78
95
351
298
53


79
86
202
144
58


80
98
141
141
0


81
128
140
140
0


82
109
131
131
0


83
103
129
129
0


84
96
104
104
0


85
89
91
91
0


86
85
87
13
74


87
92
85
0
85


88
93
85
85
0


89
87
64
1
63


90
104
43
21
0


91
91
31
10
21


92
120
22
22
0


93
122
21
0
21


94
130
19
19
0


95
107
15
15
0


96
129
10
0
10


97
123
9
0
9


98
113
3
0
3




SELECT  
  CONCAT(start_station_name, " to ", end_station_name) as route,  
  COUNT(*) as num_trips 
FROM  
  `bigquery-public-data.new_york.citibike_trips`
WHERE gender = "female"
AND CAST(starttime as string) LIKE '2016%'
GROUP BY start_station_name, end_station_name
ORDER BY num_trips DESC
LIMIT 5


Row
route
num_trips


1
W 21 St & 6 Ave to W 22 St & 10 Ave
942


2
N 6 St & Bedford Ave to Wythe Ave & Metropolitan Ave
905


3
W 21 St & 6 Ave to 9 Ave & W 22 St
809


4
Wythe Ave & Metropolitan Ave to N 6 St & Bedford Ave
769


5
W 22 St & 10 Ave to W 21 St & 6 Ave
765









SELECT  
  bikeid,  
  COUNT(*) c 
FROM `bigquery-public-data.new_york.citibike_trips`
GROUP BY 1
ORDER BY c DESC
Row
bikeid
c


1
17526
5594


2
15731
5567


3
17747
5554


4
20233
5535


5
18104
5517


6
16941
5477


7
19398
5425


8
18111
5417


9
16260
5416


10
20296
5405


11
16254
5400


12
17530
5394


13
16346
5387


14
17871
5385


15
14886
5380


16
15139
5377


17
18630
5374


18
14887
5371


19
17784
5365


20
18903
5353


21
17783
5352


22
18393
5351


23
16443
5349


24
20590
5347


25
14604
5345


26
19633
5343


27
15254
5335


28
18549
5329


29
19261
5325


30
17310
5320


31
17279
5316


32
18442
5312


33
15432
5309


34
19956
5302


35
16326
5296


36
14862
5283


37
17289
5279


38
18281
5277


39
16158
5271


40
18731
5266


41
16758
5265


42
16739
5265


43
18783
5263


44
18478
5261


45
16131
5261


46
16014
5260


47
18089
5260


48
14986
5258


49
17750
5255


50
17014
5250


51
18081
5250


52
16566
5249


53
18681
5243


54
16557
5229


55
20174
5228


56
15409
5223


57
17802
5218


58
15128
5217


59
18800
5214


60
15948
5214


61
20358
5211


62
17910
5209


63
16716
5207


64
17734
5206


65
15926
5203


66
17479
5203


67
16743
5200


68
14851
5198


69
17257
5197


70
16614
5195


71
18713
5195


72
20084
5191


73
14882
5188


74
19165
5186


75
19455
5186


76
18060
5182


77
15589
5182


78
18158
5182


79
17062
5182


80
15811
5180


81
16573
5179


82
15027
5178


83
19831
5176


84
14829
5172


85
16129
5172


86
18091
5172


87
19262
5169


88
19172
5166


89
19725
5165


90
15029
5165


91
18976
5164


92
19366
5164


93
19769
5163


94
16455
5162


95
15448
5158


96
20003
5157


97
19123
5153


98
15644
5153


99
18673
5153


100
17085
5150




SELECT  
  starttime,  
  start_station_latitude,  
  start_station_longitude 
FROM `bigquery-public-data.new_york.citibike_trips`
WHERE cast(bikeid as int64) = 17526
ORDER BY starttime

Rowstarttimestart_station_latitudestart_station_longitude1
2013-07-01 06:02:00 UTC
40.71743998
-74.00583475
2
2013-07-01 08:09:05 UTC
40.71291224
-74.01020234
3
2013-07-01 21:26:44 UTC
40.69246277
-73.98963911
4
2013-07-02 19:01:48 UTC
40.69610226
-73.96751037
5
2013-07-02 20:18:28 UTC
40.68539567
-73.97431458
6
2013-07-03 03:08:11 UTC
40.68223166
-73.9614583
7
2013-07-04 20:14:54 UTC
40.68382604
-73.97632328
8
2013-07-05 08:20:38 UTC
40.68981035
-73.97493121
9
2013-07-05 21:55:03 UTC
40.74444921
-73.98303529
10
2013-07-05 23:17:41 UTC
40.73223272
-73.98889957
11
2013-07-06 00:40:32 UTC
40.71910537
-73.99973337
12
2013-07-06 14:46:12 UTC
40.68382604
-73.97632328
13
2013-07-06 15:24:02 UTC
40.71273266
-74.0046073
14
2013-07-06 16:01:58 UTC
40.71273266
-74.0046073
15
2013-07-06 16:31:18 UTC
40.68683208
-73.9796772
16
2013-07-06 17:24:12 UTC
40.71910537
-73.99973337
17
2013-07-07 15:19:20 UTC
40.71219906
-73.97948148
18
2013-07-07 16:02:58 UTC
40.70355377
-74.00670227
19
2013-07-09 10:36:01 UTC
40.736502
-73.97809472
20
2013-07-09 17:23:44 UTC
40.74444921
-73.98303529
21
2013-07-09 17:52:57 UTC
40.73454567
-73.99074142
22
2013-07-09 18:24:48 UTC
40.70530954
-74.00612572
23
2013-07-09 19:24:44 UTC
40.75594159
-74.0021163
24
2013-07-09 21:51:24 UTC
40.75594159
-74.0021163
25
2013-07-09 23:23:42 UTC
40.75645824
-73.99372222
26
2013-07-10 06:53:42 UTC
40.73587678
-73.98205027
27
2013-07-10 08:07:32 UTC
40.74780373
-73.9734419
28
2013-07-10 17:21:19 UTC
40.75149263
-73.97798848
29
2013-07-10 18:49:52 UTC
40.73492695
-73.99200509
30
2013-07-10 20:24:41 UTC
40.746745
-74.007756
31
2013-07-10 20:33:15 UTC
40.7500727
-73.99839279
32
2013-07-10 21:23:48 UTC
40.74395411
-73.99144871
33
2013-07-10 21:36:04 UTC
40.7462009
-73.98855723
34
2013-07-11 07:35:01 UTC
40.7037992
-74.00838676
35
2013-07-11 10:51:51 UTC
40.73535398
-74.00483091
36
2013-07-11 12:37:05 UTC
40.74317449
-74.00366443
37
2013-07-11 12:46:54 UTC
40.73624527
-73.98473765
38
2013-07-11 16:53:40 UTC
40.70905623
-74.01043382
39
2013-07-12 08:27:48 UTC
40.72938685
-73.97772429
40
2013-07-12 12:27:41 UTC
40.75527307
-73.98316936
41
2013-07-12 12:38:45 UTC
40.76370739
-73.9851615
42
2013-07-12 15:11:10 UTC
40.7403432
-73.98955109
43
2013-07-12 15:44:55 UTC
40.74394314
-73.97966069
44
2013-07-13 02:19:06 UTC
40.72217444
-73.98368779
45
2013-07-13 17:04:57 UTC
40.75795248
-73.97787642
46
2013-07-13 17:50:06 UTC
40.75934501
-73.96759673
47
2013-07-14 06:57:59 UTC
40.72953837
-73.98426726
48
2013-07-14 08:38:53 UTC
40.74394314
-73.97966069
49
2013-07-14 08:53:15 UTC
40.74854862
-73.98808416
50
2013-07-14 23:05:49 UTC
40.69760127
-73.99344559
51
2013-07-15 05:53:55 UTC
40.76227205
-73.98788205
52
2013-07-15 07:46:39 UTC
40.76344058
-73.98268129
53
2013-07-15 15:58:43 UTC
40.75828065
-73.97069431
54
2013-07-15 16:16:16 UTC
40.74780373
-73.9734419
55
2013-07-15 16:54:49 UTC
40.75640548
-73.9900262
56
2013-07-15 17:16:22 UTC
40.76695317
-73.98169333
57
2013-07-15 18:26:05 UTC
40.74734825
-73.99723551
58
2013-07-16 07:02:01 UTC
40.75044999
-73.99481051
59
2013-07-16 16:05:29 UTC
40.71782143
-73.97628939
60
2013-07-16 16:20:12 UTC
40.71893904
-73.99266288
61
2013-07-16 17:54:53 UTC
40.72082834
-73.97793172
62
2013-07-16 18:01:18 UTC
40.72368361
-73.97574813
63
2013-07-17 15:13:31 UTC
40.72368361
-73.97574813
64
2013-07-17 17:56:18 UTC
40.71622644
-73.98261206
65
2013-07-17 18:14:48 UTC
40.72019576
-73.98997825
66
2013-07-17 19:44:11 UTC
40.72917025
-73.99810231
67
2013-07-17 20:30:15 UTC
40.736502
-73.97809472
68
2013-07-17 20:49:07 UTC
40.75019995
-73.99093085
69
2013-07-17 21:29:32 UTC
40.76227205
-73.98788205
70
2013-07-17 23:26:44 UTC
40.74901271
-73.98848395
71
2013-07-18 07:10:50 UTC
40.74290902
-73.97706058
72
2013-07-18 11:19:58 UTC
40.72043411
-74.01020609
73
2013-07-18 12:22:08 UTC
40.71542197
-74.01121978
74
2013-07-18 12:31:58 UTC
40.72043411
-74.01020609
75
2013-07-18 12:57:56 UTC
40.71602118
-73.99974372
76
2013-07-18 13:08:13 UTC
40.72043411
-74.01020609
77
2013-07-18 13:23:42 UTC
40.71754834
-74.01322069
78
2013-07-18 17:17:21 UTC
40.72405549
-74.00965965
79
2013-07-18 18:05:55 UTC
40.70834698
-74.01713445
80
2013-07-18 20:50:33 UTC
40.7262807
-73.98978041
81
2013-07-18 21:28:04 UTC
40.74177603
-74.00149746
82
2013-07-19 01:55:52 UTC
40.73038599
-74.00214988
83
2013-07-19 06:43:30 UTC
40.70834698
-74.01713445
84
2013-07-19 13:58:55 UTC
40.7149787
-74.013012
85
2013-07-19 17:38:38 UTC
40.74317449
-74.00366443
86
2013-07-20 07:59:46 UTC
40.73047309
-73.98672378
87
2013-07-20 08:24:27 UTC
40.73331967
-73.99510132
88
2013-07-20 09:36:37 UTC
40.73704984
-73.99009296
89
2013-07-20 23:36:58 UTC
40.749156
-73.9916
90
2013-07-21 00:39:03 UTC
40.71870987
-74.0090009
91
2013-07-21 17:33:52 UTC
40.75934501
-73.96759673
92
2013-07-21 17:55:36 UTC
40.7489006
-73.97604882
93
2013-07-21 18:43:20 UTC
40.75934501
-73.96759673
94
2013-07-21 18:53:53 UTC
40.7489006
-73.97604882
95
2013-07-21 19:03:49 UTC
40.74290902
-73.97706058
96
2013-07-21 19:30:12 UTC
40.76009437
-73.99461843
97
2013-07-21 19:58:20 UTC
40.76584941
-73.98690506
98
2013-07-21 20:59:10 UTC
40.71754834
-74.01322069
99
2013-07-21 22:08:46 UTC
40.7153379
-74.01658354
100
2013-07-21 22:14:53 UTC
40.75645824
-73.99372222



